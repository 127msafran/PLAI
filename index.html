<!DOCTYPE html>
<html lang="en">
<head>
    <title>Taskify</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!--Fonts from Google-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- Bootstrap Icons CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    
    <!--Link to css styles-->
    <link rel="stylesheet" type="text/css" href="style.css">

    <link rel="icon" href="Favicon.png" type="image/x-icon">

</head>
<body>
    <header>
        <div class = "title-bg">
            <h1 class = "title">Taskify</h1>
            <p>A free planning solution to help launch your day
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-rocket-takeoff" viewBox="0 0 16 16">
                    <path d="M9.752 6.193c.599.6 1.73.437 2.528-.362s.96-1.932.362-2.531c-.599-.6-1.73-.438-2.528.361-.798.8-.96 1.933-.362 2.532"/>
                    <path d="M15.811 3.312c-.363 1.534-1.334 3.626-3.64 6.218l-.24 2.408a2.56 2.56 0 0 1-.732 1.526L8.817 15.85a.51.51 0 0 1-.867-.434l.27-1.899c.04-.28-.013-.593-.131-.956a9 9 0 0 0-.249-.657l-.082-.202c-.815-.197-1.578-.662-2.191-1.277-.614-.615-1.079-1.379-1.275-2.195l-.203-.083a10 10 0 0 0-.655-.248c-.363-.119-.675-.172-.955-.132l-1.896.27A.51.51 0 0 1 .15 7.17l2.382-2.386c.41-.41.947-.67 1.524-.734h.006l2.4-.238C9.005 1.55 11.087.582 12.623.208c.89-.217 1.59-.232 2.08-.188.244.023.435.06.57.093q.1.026.16.045c.184.06.279.13.351.295l.029.073a3.5 3.5 0 0 1 .157.721c.055.485.051 1.178-.159 2.065m-4.828 7.475.04-.04-.107 1.081a1.54 1.54 0 0 1-.44.913l-1.298 1.3.054-.38c.072-.506-.034-.993-.172-1.418a9 9 0 0 0-.164-.45c.738-.065 1.462-.38 2.087-1.006M5.205 5c-.625.626-.94 1.351-1.004 2.09a9 9 0 0 0-.45-.164c-.424-.138-.91-.244-1.416-.172l-.38.054 1.3-1.3c.245-.246.566-.401.91-.44l1.08-.107zm9.406-3.961c-.38-.034-.967-.027-1.746.163-1.558.38-3.917 1.496-6.937 4.521-.62.62-.799 1.34-.687 2.051.107.676.483 1.362 1.048 1.928.564.565 1.25.941 1.924 1.049.71.112 1.429-.067 2.048-.688 3.079-3.083 4.192-5.444 4.556-6.987.183-.771.18-1.345.138-1.713a3 3 0 0 0-.045-.283 3 3 0 0 0-.3-.041Z"/>
                    <path d="M7.009 12.139a7.6 7.6 0 0 1-1.804-1.352A7.6 7.6 0 0 1 3.794 8.86c-1.102.992-1.965 5.054-1.839 5.18.125.126 3.936-.896 5.054-1.902Z"/>
                </svg>
            </p>
        </div>
    </header>
    <div class="transition-gradient"></div>
    <main>
        <h2>Do you struggle planning your day? Taskify is here to help by organizing your tasks in the most efficient way!</h2>
        <h2>Taskify will be able to make your day a breeze, allowing you to list and then check off tasks or chores with ease</h2>
        <hr>
        <h3>Instructions:</h3>
        <ol>
            <li>
                Enter your task or chore of choice
            </li>
            <li>
                Press the "Add task" button to add your task or chore to the list
            </li>
            <li>
                You can reorder any of the tasks or chores that you have added by clicking and dragging on the card
            </li>
            <li>
                You can click the checkbox to cross off a card and it will disappear from the list
            </li>
            <li>
                The list will reorder to always be in numerical order
            </li>
        </ol>

        <div class="container mt-5">
            <div class="input-group mb-3">
              <input type="text" id="taskInput" class="form-control" placeholder="Enter your task">
              <button id="addTaskButton" class="btn custom-color"><span class = "text-light">Add Task </span><i class="bi bi-list-check text-light"></i></button>
            </div>
            <div id="taskContainer" class="row">
              <!-- Cards will be dynamically added here -->
            </div>
        </div>

        <script>
            let taskCount = 0; // Counter to keep track of the task numbers
            
            document.getElementById('addTaskButton').addEventListener('click', function () {
                const taskInput = document.getElementById('taskInput');
                const taskText = taskInput.value.trim();
                if (taskText) {
                    taskCount++; // Increment task counter
                    createTaskCard(taskText, taskCount);
                    taskInput.value = ''; // Clear input field
                }
            });

            function createTaskCard(taskText, taskNumber) {
                const taskContainer = document.getElementById('taskContainer');

                const card = document.createElement('div');
                card.className = 'col-12 draggable-card';
                card.setAttribute('draggable', 'true');
                card.setAttribute('data-task-number', taskNumber);

                card.innerHTML = `
                    <div id = "taskContainer">
                        <div class="card custom-card-bg">
                            <div class="card-body d-flex align-items-center">
                                <span class="badge custom-color-2 me-3">${taskNumber}</span>
                                <input type="checkbox" class="form-check-input me-3" onclick="toggleTask(this)">
                                <span class="task-text flex-grow-1">${taskText}</span>
                            </div>
                        </div>
                    </div>
                `;

                taskContainer.appendChild(card);

                addDragAndDropListeners(card);

                reorderTaskNumbers();
            }

            function toggleTask(checkbox) {
            const taskCard = checkbox.closest('.draggable-card');
            const taskText = checkbox.nextElementSibling;

            if (checkbox.checked) {
                taskText.classList.add('strikethrough');
                // Add a delay before removing the card
                setTimeout(() => {
                taskCard.style.transition = "opacity 0.5s ease-out"; // Fade out effect
                taskCard.style.opacity = 0; // Start fading out
                setTimeout(() => {
                    taskCard.remove(); // Remove the card after fade out
                    reorderTaskNumbers(); // Reorder task numbers after removal
                }, 500); // Ensure the card is removed after fade-out completes (500ms)
                }, 2000); // Delay of 2 seconds before starting fade-out
            } else {
                taskText.classList.remove('strikethrough');
            }
            }

            // Function to add drag-and-drop event listeners to each card
            function addDragAndDropListeners(card) {
            card.addEventListener('dragstart', (e) => {
                e.target.classList.add('dragging');
            });

            card.addEventListener('dragend', (e) => {
                e.target.classList.remove('dragging');
                reorderTaskNumbers(); // Reorder task numbers after dragging
            });

            const taskContainer = document.getElementById('taskContainer');
            taskContainer.addEventListener('dragover', (e) => {
                e.preventDefault(); // Allow the drop
                const afterElement = getDragAfterElement(taskContainer, e.clientY);
                const dragging = document.querySelector('.dragging');
                if (afterElement == null) {
                taskContainer.appendChild(dragging);
                } else {
                taskContainer.insertBefore(dragging, afterElement);
                }
            });
            }

            // Function to find the closest element where the dragged element should be placed
            function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.draggable-card:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                return { offset: offset, element: child };
                } else {
                return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
            }

            // Reorder task numbers based on their new position in the container
            function reorderTaskNumbers() {
            const taskCards = document.querySelectorAll('.draggable-card');
            taskCards.forEach((card, index) => {
                const badge = card.querySelector('.badge');
                badge.textContent = index + 1; // Update badge with the new order
            });
            }
        </script>
    </main>
</body>
</html>